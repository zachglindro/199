<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>reveal.js</title>

	<link rel="stylesheet" href="dist/reset.css">
	<link rel="stylesheet" href="dist/reveal.css">
	<link rel="stylesheet" href="dist/theme/black.css">

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="plugin/highlight/monokai.css">
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<h3>CRDT<span style="text-transform: lowercase;">s</span></h3>
				<p>Enabling Collaboration in a Decentralized Systems
				<p>
					<small>Zach Glindro</small>
			</section>
			<section>
				<section>
					<div class="icons-row" aria-hidden="false">
						<figure class="icon-figure">
							<img src="assets/git.png" alt="git icon" class="slide-icon" />
							<figcaption>git</figcaption>
						</figure>
						<figure class="icon-figure">
							<img src="assets/github.png" alt="github icon" class="slide-icon" />
							<figcaption>github</figcaption>
						</figure>
					</div>
					<style>
						.icons-row {
							display: flex;
							gap: 2rem;
							justify-content: center;
							align-items: center;
							padding: 1rem 0;
						}

						.icon-figure {
							display: flex;
							flex-direction: column;
							align-items: center;
							color: #cbd5e1;
							font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
						}

						.slide-icon {
							width: 96px;
							height: 96px;
							object-fit: contain;
							display: block;
						}

						.icon-figure figcaption {
							margin-top: .5rem;
							font-size: 0.9rem;
							color: #9ca3af;
						}

						@media (max-width: 640px) {
							.slide-icon {
								width: 64px;
								height: 64px
							}
						}
					</style>
				</section>
				<section>
					<div class="console" id="console">
						<pre class="console-output" id="console-output"></pre>
						<div class="console-input">$ <span id="console-caret"></span></div>
					</div>
				</section>
			</section>
			<section>
				<!-- Slide 3-->
				<section>
					<div class="center-graphic">
						<svg viewBox="0 0 600 360" class="network-svg" aria-hidden="true">
							<defs>
								<filter id="glow">
									<feGaussianBlur stdDeviation="4" result="coloredBlur" />
									<feMerge>
										<feMergeNode in="coloredBlur" />
										<feMergeNode in="SourceGraphic" />
									</feMerge>
								</filter>
							</defs>
							<!-- links (rendered first so they appear behind nodes) -->
							<line class="link" data-from="c1" x1="120" y1="80" x2="300" y2="180" />
							<line class="link" data-from="c2" x1="480" y1="80" x2="300" y2="180" />
							<line class="link" data-from="c3" x1="300" y1="300" x2="300" y2="180" />
							<!-- central server -->
							<g id="server" transform="translate(300,180)">
								<rect x="-36" y="-22" width="72" height="44" rx="6" ry="6" class="server-box" />
								<text x="0" y="6" text-anchor="middle" class="server-label">Server</text>
							</g>
							<!-- clients -->
							<g class="client" data-id="c1" transform="translate(120,80)">
								<circle r="18" class="client-dot" />
								<text y="34" text-anchor="middle" class="client-label">A</text>
							</g>
							<g class="client" data-id="c2" transform="translate(480,80)">
								<circle r="18" class="client-dot" />
								<text y="34" text-anchor="middle" class="client-label">B</text>
							</g>
							<g class="client" data-id="c3" transform="translate(300,300)">
								<circle r="18" class="client-dot" />
								<text y="34" text-anchor="middle" class="client-label">C</text>
							</g>
						</svg>
					</div>
					<style>
						/* keep styles local and dark-theme friendly */
						.center-graphic {
							width: 80%;
							max-width: 900px;
							margin: 0.8rem auto;
						}

						.network-svg {
							width: 100%;
							height: auto;
							display: block;
						}

						.server-box {
							fill: #111827;
							stroke: #7dd3fc;
							stroke-width: 2px;
							filter: url(#glow);
						}

						.server-label {
							fill: #7dd3fc;
							font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
							font-size: 14px
						}

						.client-dot {
							fill: #60a5fa;
							stroke: #93c5fd;
							stroke-width: 1.5px;
							cursor: pointer;
							transition: fill 200ms, opacity 200ms, transform 200ms;
						}

						.client-label {
							fill: #cbd5e1;
							font-size: 12px
						}

						.link {
							stroke: #93c5fd;
							stroke-width: 2;
							stroke-linecap: round;
							transition: stroke 200ms, opacity 200ms;
						}

						.client.offline .client-dot {
							fill: #374151;
							opacity: 0.6;
							transform: scale(0.95);
						}

						.client.offline+.link,
						.link.offline {
							stroke: #4b5563;
							opacity: 0.35;
						}

						.figure-caption {
							text-align: center;
							color: #cbd5e1;
							font-size: 12px;
							margin-top: .4rem
						}

						@media (prefers-reduced-motion: no-preference) {
							.client-dot:hover {
								transform: scale(1.12);
							}
						}
					</style>
					<script>
						// Interactive behavior: toggle client offline/online
						(function () {
							const clients = document.querySelectorAll('.center-graphic .client');
							const links = document.querySelectorAll('.center-graphic .link');
							clients.forEach(c => {
								c.addEventListener('click', function () {
									const id = c.getAttribute('data-id');
									const isOffline = c.classList.toggle('offline');
									// find corresponding link(s)
									links.forEach(l => {
										if (l.getAttribute('data-from') === id) {
											if (isOffline) { l.classList.add('offline'); }
											else { l.classList.remove('offline'); }
										}
									});
								});
							});
						})();
					</script>
				</section>
				<section>
					<p class="inline-text">Strong consistency</p>
				</section>
				<!-- New section: docs icon -->
				<section>
					<div class="icons-row" aria-hidden="false">
						<figure class="icon-figure">
							<img src="assets/docs.svg" alt="docs icon" class="slide-icon" />
							<figcaption>docs</figcaption>
						</figure>
					</div>
				</section>
			</section>
			<section>Eventual consistency</section>
			<section>CRDTs</section>
			<section>CmRDTs</section>
			<section>CvRDTs</section>
			<section>Examples</section>
			<section>PCGRID</section>
			<section>PCGRID</section>
			<section>Conclusion</section>
		</div>
	</div>

	<script src="dist/reveal.js"></script>
	<script src="plugin/notes/notes.js"></script>
	<script src="plugin/markdown/markdown.js"></script>
	<script src="plugin/highlight/highlight.js"></script>
	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			hash: true,

			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
		});
	</script>

	<!-- Inline console styles and script for the interactive slide -->
	<style>
		.console {
			background: #0b1020;
			color: #c7d2fe;
			padding: 1rem;
			border-radius: 6px;
			width: 80%;
			max-width: 900px;
			margin: 1rem auto;
			/* center horizontally */
			box-shadow: 0 10px 30px rgba(2, 6, 23, 0.6);
			font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Roboto Mono', 'Courier New', monospace;
			font-size: 20px;
		}

		.console-output {
			white-space: pre-wrap;
			min-height: 4.5rem
		}

		.console-input {
			margin-top: 0.5rem
		}

		#console-caret {
			display: inline-block;
			min-width: 1ch
		}

		@keyframes blink {

			0%,
			100% {
				opacity: 1
			}

			50% {
				opacity: 0
			}
		}

		#console-caret::after {
			content: '\00a0';
			background: #c7d2fe;
			color: #0b1020;
			padding: 0 .15rem;
			margin-left: .2rem;
			animation: blink 1s steps(1) infinite
		}
	</style>

	<script>
		// When the Reveal slide with the console is shown, run the typing simulation.
		(function () {
			function typeTo(element, text, speed, cb) {
				let i = 0;
				function step() {
					if (i <= text.length) {
						element.textContent = text.slice(0, i);
						i++;
						setTimeout(step, speed);
					} else if (cb) { cb(); }
				}
				step();
			}

			function showConflict(container) {
				const out = document.getElementById('console-output');
				const conflict = [
					"Auto-merging src/lib.rs",
					"CONFLICT (content): Merge conflict in src/lib.rs",
					"Automatic merge failed; fix conflicts and then commit the result.",
					"",
					"<<<<<<< HEAD",
					"pub trait Storage { fn get(&self, k: &str) -> BoxFuture<'_, Result<Option<Vec<u8>>, Error>>; }",
					"=======",
					"pub struct InMemoryStorage { /* uses tokio::RwLock<HashMap<String, Vec<u8>>> */ }",
					">>>>>>> feature/blob-store",
					"",
					"(resolve conflicts and then run: git add src/lib.rs)"
				].join('\n');
				out.textContent += '\n' + conflict;
			}

			// Listen for slide changes
			Reveal.on('slidechanged', function (event) {
				// check if the current slide contains our console
				const current = event.currentSlide;
				if (current && current.querySelector && current.querySelector('#console')) {
					const inputCaret = document.getElementById('console-caret');
					const out = document.getElementById('console-output');
					out.textContent = '';
					inputCaret.textContent = '';
					// simulate typing
					typeTo(inputCaret, 'git merge', 120, function () {
						// after typing, show a little pause then output conflict
						setTimeout(function () { showConflict(); }, 600);
					});
				}
			});

			// If the console slide is the initial slide, trigger typing on ready
			Reveal.on('ready', function (event) {
				const slide = Reveal.getCurrentSlide();
				if (slide && slide.querySelector && slide.querySelector('#console')) {
					const inputCaret = document.getElementById('console-caret');
					inputCaret.textContent = '';
					typeTo(inputCaret, 'git merge', 120, function () { setTimeout(function () { showConflict(); }, 600); });
				}
			});
		})();
	</script>
</body>

</html>